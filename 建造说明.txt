地图编辑脚本使用说明文档
本文档整合了脚本的更新日志与完整玩法指南，涵盖安装启动、基础操作、进阶功能、指令按键及注意事项，助力快速上手地图创建与编辑。

一、脚本概述
脚本名称：地图编辑工具
开发者：pq
核心功能：创建自定义地图、添加编辑建筑 / 载具、导出地图文件（nut/XML/ipl 格式），支持多种编辑辅助功能
反馈方式：问题可发送至作者邮箱 553387747@qq.com

二、更新日志
1.0 版本
    添加基础地图创建与编辑功能，搭建核心操作框架
1.1 版本
    修复地图无建筑时无法加载、客户端速度与 GUI 显示不符的问题
    新增指令：/savemap（保存当前地图）、/abandmap（关闭地图不保存）、/dofile <文件名>（加载 export 文件夹 nut 文件中的建筑）
    新增操作：Shift 键提升控制速度 5 倍，Alt 键降低 5 倍
    扩展功能：/dofile 加载后可控制地图内所有建筑（复制 / 删除）
    配置优化：server.cfg 第四行可自定义控制速度挡位（仅支持阿拉伯数字，空格分隔）
1.2 版本
    修复玩家退出后重新进入地图名称不显示、1.1 版本自动保存失效的问题
    自动保存优化：每 10 分钟导出 nut 文件至 export/autosave 文件夹
    新增功能：多选编辑（按住 C + 鼠标左键多选，X + 鼠标左键取消单选）、超级旋转（按 4 开关）
    新增指令：/setcross <0~150>（设置准心最大数量，默认 20）、/setcpos（设置超级旋转绝对模式旋转点）
    优化指令：/selobj（无参数单选最近建筑，加 m 多选最近建筑）、多选与单选切换逻辑（优先单选并保留多选）
    配置扩展：导出时自动添加作者与地图名称，作者可在 cfg 文件第四行修改
1.3 版本
    修复 1.2 版本导出作者信息额外多一行的问题
    新增指令：/s（记录坐标至 export 文件夹）、/delallveh（删除所有载具）
    新增功能：按下 M 键显示常用建筑菜单（松开关闭，左下角 / 右下角翻页）
    配置优化：cfg 文件新增自动保存时间（默认 600 秒，最低 300 秒）、初始加载地图名称（默认 null 不加载）
    配置规则：cfg 自定义选项后需加且仅加一个空格
1.4 版本
    修复 M 键建筑菜单、GUI 字体在屏幕调整后不适应的问题
    新增指令：/hide（射击原版建筑隐藏）、/tp <编号>（设置 / 传送至传送点）、/copy < 方向 > < 数量 > < 间距 >（批量复制建筑）
    新增功能：W+C 组合键快速向前飞行、开车时鼠标左键快速加速、ipl 转换器（export/ipl convert/ipl.txt 导入代码）
    优化体验：服务器自动记录上次离开位置，下次进入自动返回；/selobj 不选择正在编辑的建筑物
1.5 版本
    新增功能：xml 转换 nut/ipl（转换方法同 ipl）、玩家死亡后复活至死亡点、cfg 自动对齐设置（true 时建筑默认面朝自己）
    新增指令：/hidelist（查看隐藏建筑列表）、/show <ID/all>（显示隐藏建筑）
    操作优化：按 E 键使编辑物体面朝自己、指令输入错误显示红字提示
    日志功能：保存玩家聊天记录、服务器公屏信息及数据库操作记录至控制台
    修复问题：T 键与其他绑定键同时按下触发异常、Enter 键功能异常
1.6 版本
    修复 1.5 版本地图无法加载的问题
    退回 1.5 版本 “数据库查询执行记录显示” 功能，优化脚本事件与函数
    新增指令：/caddobj（射击原版建筑复制相同位置建筑）、/frozenmode（编辑时冻结自身开关）、/guntpmode（射击传送功能开关）、/wep（刷武器）、/skin（改皮肤）、/time（改服务器时间）、/tp <X> <Y> <Z>（传送至指定坐标）、/disarm（清除所有武器）、/col <颜色 1> < 颜色 2>（修改车辆颜色）、/exportveh（导出所有载具至 export 文件夹）
    优化体验：补齐官方插件、GUI 新增 A 值（Z 轴旋转方向）、E 键旋转对齐逻辑、修复 1.5 版本编辑时 W+C 飞行的问题
1.7 版本
    飞行模式退回到 1.1 版本样式
    更新规则：单独创建文件夹并复制旧版本 database 文件，即可加载历史地图数据

三、安装与启动流程
运行 server64.exe 启动服务器
打开联机工具，添加 IP 地址：127.0.0.1:8192
连接服务器后，按照文档指引进行地图创建与编辑操作

四、核心操作指南
基础创建流程
    必须先创建地图：输入指令 /createmap <地图名字>（例：/createmap test），创建后即可添加建筑
    添加建筑：输入指令 /addobj <模型ID>（例：/addobj 398 添加垃圾袋）
    编辑建筑：通过上下左右键、PageUp/PageDown 控制位置，按 1 切换控制速度，按 2 切换移动 / 旋转模式
    保存与关闭：/savemap（保存地图）、/closemap（保存并关闭）、/abandmap（关闭不保存）
    加载与导出：/loadmap <地图名字>（加载已关闭地图）、/exportmap（导出地图至 export 文件夹，导出后关闭地图）
进阶操作技巧
    建筑选择：用 M60 射击建筑可直接选择编辑；栅栏等无法射击选择的建筑，使用 /selectobj 指令选择最近建筑
    编辑逻辑：按 3 切换 Relative（相对玩家，按 W 朝玩家前方移动）/Absolute（绝对世界，按 W 朝北移动）模式，Absolute 模式与 VCCC 服务器控制方法一致
    批量操作：使用 /copy <方向> < 数量 > < 间距 > 指令批量复制建筑（方向支持 before/after/left/right/up/down）
    载具操作：/cc <载具名称 / 模型 ID> 创建载具（W + 鼠标右键快速创建 PCJ600），/fix 修车，/ff 翻转车辆，/col < 颜色 1> < 颜色 2 > 修改车辆颜色

五、模型 ID 获取方式
射击原版建筑可直接获取对应模型 ID（部分如路灯、车库门可能无法显示）
在线查询：
    浏览http://wiki.thijn.ovh/index.php?title=Pickup_Models 获取常见建筑 ID
工具获取：
    KED 工具：下载地址https://www.gtagarage.com/mods/show.php?id=8322
    Moo 工具：下载地址http://vctools.ysepan.com（路径：MOD 制作及修改工具→地图编辑工具→MooMapper 汉化版）
    MED 工具：教程链接https://www.bilibili.com/video/BV11h411a7hk/?spm_id_from=333.337.search-card.all.click&vd_source=531dc841c9b5063028ae1eaaa09e994d
    格式转换：通过https://thijn.minelord.com/vcmp/iplConvert/ 转换 IPL 代码至 nut/XML 格式（勿开启 “修复 KED 旋转”）

六、完整指令表
基础功能指令
    /fps：查看 FPS
    /pos：查看玩家坐标和角度
    /s：保存并导出坐标
    /fly：开启 / 关闭飞行功能
    /autosave：开启 / 关闭自动保存（服务器默认每 5 分钟保存）
    /cmds：查看服务器所有指令
    /exec <代码>：开发者专用指令（不公开详细说明）
地图操作指令
    /createmap <地图名字>：创建地图（必须先创建才能添加建筑）
    /loadmap <地图名字>：加载已创建的地图
    /savemap：保存当前地图
    /abandmap：关闭地图（不保存修改）
    /closemap：保存并关闭当前地图（无法创建 / 加载地图时需检查是否已关闭当前地图）
    /exportmap：保存并导出地图至 export 文件夹（导出后关闭地图）
    /maplist：查看所有已创建的地图
    /exportveh：导出所有载具至 export 文件夹
建筑 / 物体编辑指令
    /addobj <建筑物 ID>：添加建筑到当前地图
    /dofile <文件名>：加载 export 文件夹中 nut 文件的建筑
    /copy <方向> < 数量 > < 间距 >：批量复制建筑（方向：before/after/left/right/up/down）
    /saveobj：保存正在编辑的建筑物
    /setalpha <0~255>：设置建筑透明度
    /selectobj：选择距离最近的建筑（适用于无法射击选择的物体）
    /selobj：无参数单选最近建筑，加 m（/selobj m）多选最近建筑
    /setcross <0~150>：设置编辑准心最大数量（0 为关闭）
    /setcpos：设置超级旋转绝对模式的旋转点（单选模式下锁定目标建筑）
    /hide：输入后射击原版建筑可隐藏（部分建筑不支持）
    /hidelist：查看所有隐藏建筑的 ID 和模型 ID
    /show <ID/all>：显示隐藏建筑（all 恢复全部）
    /caddobj：射击原版建筑可复制相同位置的建筑
载具与角色指令
    /cc <载具名称 / 模型 ID>：创建载具
    /fix：修复载具
    /ff：翻转载具
    /delallveh：删除所有载具
    /wep：刷出武器
    /skin：改变自身皮肤
    /time：更改服务器时间
    /disarm：清除身上所有武器
传送与移动指令
    /tp <编号>：设置或传送到指定编号传送点
    /tp <X> <Y> <Z>：传送到指定坐标
    /guntpmode：开启 / 关闭射击传送功能
编辑辅助指令
    /frozenmode：开启 / 关闭编辑建筑时自动冻结自身

七、按键操作说明
上下左右键	        飞行模式：前后左右飞行；编辑模式：控制物体前后左右移动
PageUp/PageDown	    飞行模式：上升 / 下降；编辑模式：控制物体上下移动
Shift	提升控制速度 5 倍
Alt	降低控制速度 5 倍
1	切换飞行 / 物体控制速度挡位（默认 1，共 9 挡：0.0625/0.125/0.25/0.75/1/1.5/2.25/3.5/5）
2	切换物体编辑模式（移动模式 / 旋转模式）
3	切换物体编辑逻辑（Relative：相对玩家；Absolute：绝对世界）
4	开启 / 关闭超级旋转模式（绕指定点旋转，非物体自身旋转）
BackSpace	取消物体编辑（不自动保存）
Delete	删除正在编辑的物体（无法恢复）
Ctrl+C	复制正在编辑的物体（复制后自动旋转）
E	使正在编辑的物体面朝自己
M	按住显示常用建筑菜单，松开关闭（左下角 / 右下角翻页）
W+C	快速向前方飞行
W + 鼠标右键	快速创建 PCJ600 载具
鼠标左键（开车时）	快速加速载具
C + 鼠标左键	多选射击到的建筑
X + 鼠标左键	取消多选列表中单个建筑的选择

八、配置文件设置（cfg 文件）
自动保存时间：默认 600 秒，最低 300 秒，可自定义修改
初始加载地图：默认 null（不加载任何地图），可指定已创建的地图名称
作者信息：第四行可修改，导出地图时自动添加
控制速度挡位：server.cfg 第四行，支持自定义阿拉伯数字（空格分隔）
自动对齐设置：新增配置项，设为 true 时，新建建筑默认面朝自己（默认面朝北方）
配置规则：所有自定义选项后需加且仅加一个空格

九、格式转换工具使用
1. ipl 转 nut/XML
复制 ipl 代码至 export/ipl convert/ipl.txt
启动工具自动转换，转换后文件保存至 export 文件夹
注意：转换完成后需手动删除 ipl.txt 中的代码
2. XML 转 nut/ipl
转换方法与 ipl 转换一致，复制 XML 代码至对应文件即可

十、注意事项
文件夹保护：禁止删除 export 文件夹（影响地图导出）和 database 文件（存储地图建筑数据）；若误删 database，重启 server64.exe 会自动创建空白文件
建筑限制：避免添加武器类建筑（如 ID277），会导致 XML 文件无法加载
操作规范：创建建筑前必须先创建地图；无法创建 / 加载地图时，需检查是否已关闭当前地图
版本更新：更新时可单独创建文件夹，复制旧版本 database 文件即可加载历史地图
指令限制：/copy 批量复制的建筑不会立刻保存，需手动执行保存指令
隐藏功能：部分原版建筑可能无法通过 /hide 指令隐藏，属正常现象